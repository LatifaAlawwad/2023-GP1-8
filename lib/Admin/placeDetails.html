<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin Dashboard">
    <title>تفاصيل المكان</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/jquery.slick/1.6.0/slick.css"/>
    <link rel="stylesheet" href="commonStyles.css">
    <style>



        #Heading {
            font-size: 24px;
            color: #1d5011;
            text-align: center;

        }

        .container {
            display: flex;
            min-height: 100vh;

        }

        .content {
            flex-grow: 1;
            padding: 20px;
            text-align: center;
        }



        .logo {
  text-align: left;
  padding: 10px;
  width: 150px;
  position: absolute;
  top: 0;
  left: 0;
}

.logo img {
  width: 130px;
  height: 130px;
}

        /* Text style */
        .header-text {
            margin-left: 60px;
        }

        .header-text a {
            color: white;
            text-decoration: none;
            padding: 10px;
        }

        .header-text a:hover {
            background-color: #f2f2f2;
            color: #90c996;
        }

     .container {
    display: flex;
    flex-direction: column;
    max-width: 900px;
    margin: auto;
    align-items: center;
    justify-content: center;
    min-height: 80vh;
    text-align: right;
    margin-top: 3%;
    margin-bottom: 120px;
}


        .content {
            max-width: 80%;
            width: 90%;
            padding: 20px;
            background: #F9FFF9;
            box-shadow: 1px 2px 6px #124304;
            border-radius: 10px;
            text-align: right;
            word-wrap: break-word;
        }

        /* Style for the details */
        h2 {
            font-size: 20px;
            margin-bottom: 10px;
            color: green;
        }

        p {
            font-size: 14px;
            margin-bottom: 8px;
            color: black;
        }
.image-container {
    position: relative;
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    justify-content: flex-start;
    padding: 10px;
    border: 2px solid #ddd;
    border-radius: 5px;
    background-color: #f9f9f9;
    overflow-x: auto;
    max-height: 200px;
    min-height: 150px;
     box-shadow: 2px 4px 4px rgba(0, 0, 0, 0.1);
}

.image-container img {
    max-height: 150px;
    max-width: 150px;
    object-fit: cover;
    border-radius: 5px;
    margin-right: 10px;
    margin-bottom: 0px;
    opacity: 1;
}


      /* Add this style for the enlarged image */
.large-image-container {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    justify-content: center;
    align-items: center;
    z-index: 2;
}

.large-image-container.active {
    display: flex;
}

.large-image-container img {
    max-width: 90%;
    max-height: 90%;
}


.image-container.active {
    display: none;
}

#workingDaysTable {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    overflow: hidden;
}

#workingDaysTable th, #workingDaysTable td {
    border: none;
    padding: 8px;
    text-align: center;
}

#workingDaysTable th {

    color: #4f4f4f;
}

#workingDaysTable tr {
    border-bottom: 1px solid #ccc;
}




 .arrow {
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #1d5011;
        color: white;
        padding: 10px;
        margin-bottom: 10px;
    }

    .arrow span {
        font-size: 24px;
    }

    /* Add this style for the description container */
    .description-container {
        border-bottom: 2px solid #1d5011;
        margin-bottom: 10px;
    }


    </style>
</head>
<body class="background-place-details">
<!-- Header with navigation links -->
<div class="header">
    <!-- Logo on the left side without background -->
    <div class="logo">
        <img src="images/logowithname.png" alt="Logo">
    </div>



    <!-- Content of the Homepage -->
    <div class="container">
        <div class="content">
            <h1 id="Heading">تفاصيل المكان</h1>
            <div id="placeDetails">
                <!-- Place details will be displayed here -->
            </div>
            <div class="image-container" id="imageContainer">
                <!-- Images will be displayed in the container -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        &copy; 2023 S'hail Admin
    </div>
    <!-- Menu Icon -->
    <div class="menu-icon" onclick="toggleSideNav()">
        <span></span>
        <span></span>
        <span></span>
    </div>
    <!-- Vertical navigation bar on the right -->
    <div class="sidenav-right" id="navbar">
        <!-- Navigation links -->

        <a href="home.html">الصفحة الرئيسية</a>
        <a href="ManagePlaces.html">إدارة الأماكن</a>
        <a href="RequestedPlaces.html">طلبات الإضافة</a>
        <a href="AddPlace.html">إضافة مكان</a>
        <a href="ShailAddings.html">إضافات سهيل</a>
        <a class="logout" href="logout.html">تسجيل الخروج</a>
    </div>
</div>
<script >
    // Toggle the side navigation bar
    function toggleSideNav() {
        const sideNav = document.getElementById('navbar'); // Change the id to "navbar"
        sideNav.classList.toggle('active');

        const menuIcon = document.querySelector('.menu-icon');
        menuIcon.classList.toggle('active');
    }
</script>


<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.slick/1.6.0/slick.min.js"></script>
<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
    import { getFirestore, doc, collection, getDoc } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-firestore.js";

    document.addEventListener('DOMContentLoaded', async () => {

       const firebaseConfig = {
          apiKey: "AIzaSyBKCStEljQdADcPTDJPG49jPYdj65Ld-aE",
            appId: "1:652061667089:web:1103ef9a5c45ea6d1c26b0",
             messagingSenderId: "652061667089",
           projectId: "fir-hail-ec5a7"
        };


        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Get the place ID from the URL
        const urlParams = new URLSearchParams(window.location.search);
        const placeId = urlParams.get("placeId");
        const dbplace = urlParams.get("db");
console.log("placeId:", placeId);
console.log("dbplace:", dbplace);


 let placeDocRef="";
        if (dbplace == "pending"){
        // Reference to the "PendingPlaces" collection and the specific place document
         const addedPlacesRef = collection(db, 'PendingPlaces');
         placeDocRef = doc(addedPlacesRef, placeId);
}else {
// Reference to the "ApprovedPlaces" collection and the specific place document
        const addedPlacesRef = collection(db, 'ApprovedPlacesWeb');
         placeDocRef = doc(addedPlacesRef, placeId);
        }





        // Function to fetch and display place details and images
        const displayPlaceDetails = async () => {
            try {
                const placeDoc = await getDoc(placeDocRef);
                if (placeDoc.exists()) {
                    const placeData = placeDoc.data();
                    const placeName = placeData.placeName;
                    const description = placeData.description;
                    const neighbourhood = placeData.neighbourhood;
                    const city = placeData.city;
                    const category = placeData.category;
                    const WebLink = placeData.WebLink;
                    let hasValet = placeData.hasValetServiced;
                    const images = placeData.images;

   if(hasValet== null ){ hasValet='لم يتم التحديد';}else {
if (!hasValet){hasValet='لا';}else {hasValet='نعم';}  }

let weblinkHtml = '';

if (!WebLink || WebLink === '') {
   weblinkHtml = `<p>
       لم يتم التحديد
        <strong style="color: #1d5011; font-size: 18px; display: inline-block; margin-right: 5px;">:رابط الموقع الإلكتروني</strong>
    </p>`;
} else {
    weblinkHtml = `<p>
        <a href="${WebLink}" style="color: blue; text-decoration: underline;" target="_blank">${WebLink}</a>
        <strong style="color: #1d5011; font-size: 18px; display: inline-block; margin-right: 5px;">:رابط الموقع الإلكتروني</strong>
    </p>`;

}


const workedDaysArray = placeData.WorkedDays;
let workingDaysHTML = '';

if (!workedDaysArray || workedDaysArray.length === 0) {
    workingDaysHTML = '<span>لا توجد ساعات عمل</span>';
} else {
    workingDaysHTML = '<table id="workingDaysTable">';
    workingDaysHTML += '<tr><th>وقت الإغلاق</th><th>وقت الإفتتاح</th><th>اليوم</th></tr>';

    workedDaysArray.forEach((dayObject, index) => {
        const day = dayObject.day;
        const openingTime = dayObject['وقت الإفتتاح'];
        const closingTime = dayObject['وقت الإغلاق'];

        const isOpen24Hours = openingTime === '00:00 AM' && closingTime=== '12:59 PM' ;


        if (isOpen24Hours) {
           workingDaysHTML += `
    <tr>
         <td colspan="2">مفتوح 24 ساعة</td>

        <td>${day}</td>
    </tr>`;
        } else {
            workingDaysHTML += `<tr><td>${closingTime}</td><td>${openingTime}</td><td>${day}</td></tr>`;
        }
    });

    workingDaysHTML += '</table>';
}












if (category == "مراكز تسوق") {
    let INorOUT = placeData.INorOUT;
    let hasFoodCourt = placeData.hasFoodCourt;
    let hasPlayArea = placeData.hasPlayArea;
    let hasSupermarket = placeData.hasSupermarket;
    let hasCinema = placeData.hasCinema;



      if(INorOUT== null ){ INorOUT='لم يتم التحديد';}

    if(hasFoodCourt== null ){ hasFoodCourt='لم يتم التحديد';}else {
if (!hasFoodCourt){hasFoodCourt='لا';}else {hasFoodCourt='نعم';}    }




if(hasPlayArea== null ){ hasPlayArea='لم يتم التحديد';}else {
if (!hasPlayArea){hasPlayArea='لا';}else {hasPlayArea='نعم';}  }




if(hasSupermarket== null ){ hasSupermarket='لم يتم التحديد';}else {
if (!hasSupermarket){hasSupermarket='لا';}else {hasSupermarket='نعم';}}



if(hasCinema== null ){ hasCinema='لم يتم التحديد';}else {
if (!hasCinema){hasCinema='لا';}else {hasCinema='نعم';}   }








let shopOptions = placeData.shopOptions;
let shopOptionsHTML = '';

if (!shopOptions || shopOptions.length === 0) {
    shopOptionsHTML = '<span>لا توجد خيارات للمتجر</span>';
} else {
    shopOptionsHTML = shopOptions.map((item) => `<li style=" font-size: 16px;">${item}<span style="color: #1d5011; font-size: 1.5em;">&bull;</span></li>`).join('');
}







    const placeDetails = document.getElementById('placeDetails');
    placeDetails.innerHTML = `
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${placeName}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:اسم المكان</strong></p>
        <p>
         <span style="color: black; font-size: 16px; margin-right: 5px;">${city}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block; margin-right:10px;">:الحي</strong>
        <span style="color: black; font-size: 16px; margin-right: 5px;">${neighbourhood}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block; ">:المدينة</strong>
        </p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${category}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:الفئة</strong></p>
         <div style="display: flex; justify-content: flex-end; align-items: baseline;">
    <span style="color: black; font-size: 16px; margin-right: 5px;">${description}</span>
    <strong style="color: #1d5011; font-size: 18px; margin-right: 5px;">:وصف المكان</strong>
    </div>
    ${weblinkHtml}

    <p><span style="color: black; font-size: 16px; margin-right: 5px;"></span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:ساعات العمل</strong></p>



          ${workingDaysHTML}


<p><span style="color: black; font-size: 16px; margin-right: 5px;"></span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:خيارات المتجر</strong></p>
    <ul style="list-style-type: none; margin-right: 20px; padding-inline-start: 0;">${shopOptionsHTML}</ul>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${hasValet}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل توجد خدمة ركن السيارات</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${hasPlayArea}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل توجد منطقة ألعاب</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${hasFoodCourt}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل توجد منطقة مطاعم</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${hasSupermarket}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل توجد سوبرماركت</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${hasCinema}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل يوجد سينما</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${INorOUT}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل المكان داخلي أم خارجي</strong></p>
                        <p><span style="color: black; font-size: 16px; margin-right: 5px;"></span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:الصور</strong></p>
    `;










} else if (category == "فعاليات و ترفيه") {

    let isTemporary = placeData.isTemporary;
    const startDate = placeData.startDate;
    const finishDate = placeData.finishDate;
    let INorOUT = placeData.INorOUT;
    const shopOptions=placeData.shopOptions;
    let hasReservation = placeData.hasReservation;
    const reservationDetails = placeData.reservationDetails;
    const typeEnt=placeData.typeEnt;
let hasreservation='';
let istemporary='';
       if(isTemporary== null ){ istemporary='لم يتم التحديد';} else{
if (!isTemporary){istemporary='لا';}else {istemporary='نعم';}}

 if(hasReservation== null ){ hasreservation='لم يتم التحديد';} else{
if (!hasReservation){hasreservation='لا';}else {hasreservation='نعم';} }

   if(INorOUT== null ){ INorOUT='لم يتم التحديد';}




    const placeDetails = document.getElementById('placeDetails');
    placeDetails.innerHTML = `
           <p><span style="color: black; font-size: 16px; margin-right: 5px;">${placeName}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:اسم المكان</strong></p>


 <p>
         <span style="color: black; font-size: 16px; margin-right: 5px;">${city}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block; margin-right:10px;">:الحي</strong>
        <span style="color: black; font-size: 16px; margin-right: 5px;">${neighbourhood}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block; ">:المدينة</strong>
        </p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${category}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:الفئة</strong></p>
          <div style="display: flex; justify-content: flex-end; align-items: baseline;">
    <span style="color: black; font-size: 16px; margin-right: 5px;">${description}</span>
    <strong style="color: #1d5011; font-size: 18px; margin-right: 5px;">:الوصف</strong>
</div>
    ${weblinkHtml}

                 <p><span style="color: black; font-size: 16px; margin-right: 5px;"></span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:ساعات العمل</strong></p>
         ${workingDaysHTML}

        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${typeEnt}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:نوع الفعالية</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${istemporary}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل الفعالية موقتة</strong></p>
        ${isTemporary ? `<p><span style="color: black; font-size: 16px; margin-right: 5px;">${startDate}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:تاريخ البداية</strong></p>` : ''}
        ${isTemporary ? `<p><span style="color: black; font-size: 16px; margin-right: 5px;">${finishDate}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:تاريخ النهاية</strong></p>` : ''}
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${INorOUT}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل المكان داخلي أم خارجي</strong></p>
                <p><span style="color: black; font-size: 16px; margin-right: 5px;">${hasValet}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل توجد خدمة ركن السيارات</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${hasreservation}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل يتطلب حجز</strong></p>
        ${hasReservation ? `<p><span style="color: black; font-size: 16px; margin-right: 5px;">${reservationDetails}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:تفاصيل الحجز</strong></p>` : ''}
                        <p><span style="color: black; font-size: 16px; margin-right: 5px;"></span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:الصور</strong></p>
    `;








} else {
    const priceRange = placeData.priceRange;
    const cuisine = placeData.cuisine;
    const atmosphere = placeData.atmosphere;
    const serves = placeData.serves;
    let allowChildren = placeData.allowChildren;
    let hasReservation = placeData.hasReservation;
    const reservationDetails = placeData.reservationDetails;
let hasreservation='';


 if(hasReservation== null ){ hasreservation='لم يتم التحديد';} else{

if (!hasReservation){hasreservation='لا';}else {hasreservation='نعم';} }


  if(allowChildren== null ){ allowChildren='لم يتم التحديد';} else{
if (!allowChildren){allowChildren='لا';}else {allowChildren='نعم';}  }








    const placeDetails = document.getElementById('placeDetails');
    placeDetails.innerHTML = `
         <p><span style="color: black; font-size: 16px; margin-right: 5px;">${placeName}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:اسم المكان</strong></p>


        <p>
         <span style="color: black; font-size: 16px; margin-right: 5px;">${city}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block; margin-right:10px;">:الحي</strong>
        <span style="color: black; font-size: 16px; margin-right: 5px;">${neighbourhood}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block; ">:المدينة</strong>
        </p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${category}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:الفئة</strong></p>
          <div style="display: flex; justify-content: flex-end; align-items: baseline;">
    <span style="color: black; font-size: 16px; margin-right: 5px;">${description}</span>
    <strong style="color: #1d5011; font-size: 18px; margin-right: 5px;">:الوصف</strong>
</div>
    ${weblinkHtml}

                <p><span style="color: black; font-size: 16px; margin-right: 5px;"></span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:ساعات العمل</strong></p>
         ${workingDaysHTML}

        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${priceRange}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:نطاق الأسعار</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${cuisine}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:نوع الطعام</strong></p>
        <p><span style="color: black; font-size: 16px; margin-right: 5px;">${serves}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:الوجبات المقدمة</strong></p>



    <p> <span style="color: black; font-size: 16px;margin-right: 5px; ">${atmosphere}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block; ">:الجو العام</strong></p>
    <p><span style="color: black; font-size: 16px; margin-right: 5px;">${allowChildren}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل يسمح بدخول الأطفال</strong></p>
    <p><span style="color: black; font-size: 16px; margin-right: 5px;">${hasValet}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:هل توجد خدمة ركن السيارات</strong></p>
    <p> <span style="color: black; font-size: 16px;margin-right: 5px; ">${hasreservation}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block; ">:هل هناك حجز</strong></p>
     ${hasReservation ? `<p><span style="color: black; font-size: 16px; margin-right: 5px;">${reservationDetails}</span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:تفاصيل الحجز</strong></p>` : ''}
                <p><span style="color: black; font-size: 16px; margin-right: 5px;"></span><strong style="color: #1d5011; font-size: 18px; display: inline-block;">:الصور</strong></p>


`;

}








                    const imageContainer = document.getElementById('imageContainer');
                    imageContainer.innerHTML = ''; // Clear previous images

                      if (images && images.length > 0) {
                images.forEach((imageUrl) => {
                    const image = document.createElement('img');
                    image.src = imageUrl;
                    image.alt = "Place Image";
                    // Set a fixed size for all images
                    image.style.width = "150px";
                    image.style.height = "150px";
                    imageContainer.appendChild(image);
                });
            } else {
                // If no images are available, display a message
                 const noImageMessage = document.createElement('p');
                noImageMessage.textContent = "لا توجد صور لهذا المكان";
                noImageMessage.style.color = "#1d5011";
                noImageMessage.style.textAlign = "center";
                noImageMessage.style.marginLeft = '40%';
                 noImageMessage.style.marginRight = '40%';
                imageContainer.appendChild(noImageMessage);
            }
                } else {
                    console.error('Place not found.');
                }
            } catch (error) {
                console.error('Error getting place details: ', error);
            }
        };









const imageContainer = document.getElementById('imageContainer');
        const largeImageContainer = document.createElement('div');
        largeImageContainer.className = 'large-image-container';
        document.body.appendChild(largeImageContainer);

    // Add a click event listener to each image
   imageContainer.addEventListener('click', (event) => {
          if (event.target.tagName === 'IMG') {
              const imageUrl = event.target.src;

              // Create an enlarged image element
              const largeImage = document.createElement('img');
              largeImage.src = imageUrl;
              largeImage.alt = 'Enlarged Image';

              largeImageContainer.innerHTML = '';
              largeImageContainer.appendChild(largeImage);

              largeImageContainer.classList.add('active');
              imageContainer.classList.add('active');
          }
      });

      // Function to hide the enlarged image container when clicked outside
      largeImageContainer.addEventListener('click', () => {
          largeImageContainer.classList.remove('active');
          imageContainer.classList.remove('active');
      });



        // Call the displayPlaceDetails function to retrieve and display place details with images
        displayPlaceDetails();
    });
</script>
</body>
</html>

